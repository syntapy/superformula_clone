from node:22-bookworm

env UID=1000
env GID=1000
env UNAME=node

run groupadd -g $GID -o user
#run useradd -m -u $UID -g $GID -o -s /bin/bash $UNAME

run mkdir /site
workdir /site

copy . .

# Sigh...yes, I needed to do this =/
run chown -R node:node /root

volume ["./"]

run apt-get update && apt-get upgrade -y && \
    npm install -g npm@latest && \
    npm install -g gatsby-cli

user $UNAME
